#To create Employee table
CREATE TABLE Employee (
    emp_id NUMBER PRIMARY KEY,
    dept_id NUMBER,
    emp_name VARCHAR2(30),
    DoJ DATE,
    salary NUMBER(10,2),
    commission NUMBER(10,2),
    job_title VARCHAR2(20)
);
#To create the Salary_Increment table
CREATE TABLE Salary_Increment (
    emp_id NUMBER REFERENCES Employee(emp_id),
    new_salary NUMBER(10,2)
);


SET SERVEROUTPUT ON;

DECLARE
    v_emp_id Employee.emp_id%TYPE := &emp_id;
    v_salary Employee.salary%TYPE;
    v_doj Employee.DoJ%TYPE;
    v_new_salary NUMBER(10,2);
    v_experience NUMBER(5,2);
    
    -- User-defined exception
    e_no_employee EXCEPTION;

BEGIN
    -- Get employee details
    SELECT salary, DoJ INTO v_salary, v_doj
    FROM Employee
    WHERE emp_id = v_emp_id;
    
    -- Calculate experience in years
    v_experience := TRUNC(MONTHS_BETWEEN(SYSDATE, v_doj) / 12);
    
    -- Check experience and calculate new salary
    IF v_experience > 10 THEN
        v_new_salary := v_salary + (v_salary * 0.20);
    ELSIF v_experience > 5 THEN
        v_new_salary := v_salary + (v_salary * 0.10);
    ELSE
        v_new_salary := v_salary + (v_salary * 0.05);
    END IF;
    
    -- Insert new salary into Salary_Increment table
    INSERT INTO Salary_Increment VALUES (v_emp_id, v_new_salary);
    
    DBMS_OUTPUT.PUT_LINE('Employee ID: ' || v_emp_id);
    DBMS_OUTPUT.PUT_LINE('Experience: ' || v_experience || ' years');
    DBMS_OUTPUT.PUT_LINE('Old Salary: ' || v_salary);
    DBMS_OUTPUT.PUT_LINE('New Salary: ' || v_new_salary);
    
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        DBMS_OUTPUT.PUT_LINE('❌ Employee with ID ' || v_emp_id || ' not found.');
    WHEN e_no_employee THEN
        DBMS_OUTPUT.PUT_LINE('❌ Custom Exception: No such employee.');
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('⚠️ Error: ' || SQLERRM);
END;
/


