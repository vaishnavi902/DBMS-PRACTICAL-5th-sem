#To create the table EMPLOYEE
CREATE TABLE Employee (
    emp_id NUMBER PRIMARY KEY,
    dept_id NUMBER,
    emp_name VARCHAR2(30),
    DoJ DATE,
    salary NUMBER(10,2),
    commission NUMBER(10,2),
    job_title VARCHAR2(30)
);


SET SERVEROUTPUT ON;

CREATE OR REPLACE PROCEDURE calc_commission
IS
    v_experience NUMBER;
BEGIN
    FOR rec IN (SELECT emp_id, salary, DoJ FROM Employee)
    LOOP
        v_experience := TRUNC(MONTHS_BETWEEN(SYSDATE, rec.DoJ) / 12);

        IF rec.salary > 10000 THEN
            UPDATE Employee SET commission = rec.salary * 0.004 WHERE emp_id = rec.emp_id;

        ELSIF rec.salary < 10000 AND v_experience > 10 THEN
            UPDATE Employee SET commission = rec.salary * 0.0035 WHERE emp_id = rec.emp_id;

        ELSIF rec.salary < 3000 THEN
            UPDATE Employee SET commission = rec.salary * 0.0025 WHERE emp_id = rec.emp_id;

        ELSE
            UPDATE Employee SET commission = rec.salary * 0.0015 WHERE emp_id = rec.emp_id;
        END IF;
    END LOOP;

    DBMS_OUTPUT.PUT_LINE('✅ Commission updated successfully for all employees.');
EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('⚠️ Error: ' || SQLERRM);
END;
/

#Function Code Execution 
EXEC calc_commission;
